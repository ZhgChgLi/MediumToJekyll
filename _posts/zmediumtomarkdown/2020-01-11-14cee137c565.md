---
title: iOS UIViewController 轉場二三事
author: ZhgChgLi
date: 2020-01-11T18:41:06.640+0000
last_modified_at: 2021-02-24T01:37:09.676+0000
categories: ZRealm Dev.
tags: [ios,ios-app-development,swift,uiviewcontroller,mobile-app-development]
description: UIViewController 下拉關閉/上拉出現/全頁右滑返回 效果全解
image:
  path: assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif
render_with_liquid: false
---

### iOS UIViewController 轉場二三事

UIViewController 下拉關閉/上拉出現/全頁右滑返回 效果全解
### 前言


![](/assets/14cee137c565/1*6IQTrlT4vIKR-NjLRsvZ-A.gif)


一直以來都很好奇諸如 Facebook、Line、Spotify…等等常用的 APP 是如何實作「Present 的 UIViewController 可下拉關閉」、「上拉漸入 UIViewController」、「全頁面支援手勢右滑返回」這些效果的。

因為這些效果內建都沒有，下拉關閉也直到 iOS ≥ 13 才有系統的卡片樣式支援。
#### 探索之路

不知道是不會下關鍵字還是資料本身難找，一直找不到這類功能的實踐做法，找到的資料都很含糊零散，只能東拼西湊。

一開始自己研究做法時找到 `UIPresentationController` 這個 API ，沒再深掘其他資料，就用這個方法搭配 `UIPanGestureRecognizer` 用很土炮的方式完成下拉關閉的效果；一直都覺得哪裡怪怪的，感覺會有更好的方式。

直到最近接觸新專案拜讀 [大大的文章](https://imnotyourson.com/draggable-view-controller-interactive-view-controller/){:target="_blank"} ，擴大眼界才發現有其他 API 更漂亮、更有彈性的做法可以用。


> _本篇一方面是自我紀錄，另一方面希望有幫助到跟我有一樣困惑的朋友。_ 
 

> _內容有點多，嫌麻煩的可以直接拉到底看範例，或直接下載 Github 專案回來研究！_ 




### iOS 13 卡片樣式呈現頁面

首先講最新系統內建的效果
iOS ≥ 13 後 `UIViewController.present(_:animated:completion:)` 
默認的 `modalPresentationStyle` 效果就是 `UIModalPresentationAutomatic` 片樣式呈現頁面，若想要保持之前的全頁面呈現就要特別指定回 `UIModalPresentationFullScreen` 即可。


![內建行事曆新增效果](/assets/14cee137c565/1*j0NeJfAuR2fXP56KWglS7Q.gif)

內建行事曆新增效果
#### 如何取消下拉關閉？關閉確認？

更好的使用者體驗應該要能在觸發下拉關閉時檢查有無輸入資料，有的話需要提示使用者是否捨棄動作離開。

這部分蘋果也幫我們想好了，只需實作 `UIAdaptivePresentationControllerDelegate` 裡的方法即可。
