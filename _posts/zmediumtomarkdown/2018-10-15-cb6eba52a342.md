---
title: iOS ≥ 10 Notification Service Extension 應用 (Swift)
author: ZhgChgLi
date: 2018-10-15T15:44:01.193+0000
last_modified_at: 2021-02-24T01:26:53.094+0000
categories: ZRealm Dev.
tags: [swift,push-notification,notificationservice,ios,ios-app-development]
description: 圖片推播、推播顯示統計、推播顯示前處理
image:
  path: assets/cb6eba52a342/1*8juoKO7BZiT3PQjqufWcrA.jpeg
render_with_liquid: false
---

### iOS ≥ 10 Notification Service Extension 應用 \(Swift\)

圖片推播、推播顯示統計、推播顯示前處理

關於基礎的推播建置、推播原理；網路資料很多，這邊就不再論述，本篇主要重點在如何讓APP支援圖片推播及運用新特性達成更精準的推播顯示統計．


![](/assets/cb6eba52a342/1*8juoKO7BZiT3PQjqufWcrA.jpeg)


如上圖所示，Notification Service Extension讓你在APP收到推播後能針對推播做預處理，然後才顯示推播內容

官方文件寫到，我們針對推播進來的內容做處理時，處理時限大約30秒鐘，如果超過30秒還沒CallBack，推播就會繼續執行，出現在使用者的手機．
#### 支援度

iOS ≥ 10\.0
#### 30秒可以幹嘛？
- \(目標1\) 從推播內容的圖片連結欄位下載圖片回來，並附加到推播內容上🏆



![](/assets/cb6eba52a342/1*dd2kRizi6v-AIXcMWourow.png)

- \(目標2\) 統計推播有無顯示🏆
- 推播內容修改、重組內容
- 推播內容加解密\(解密\)顯示
- _決定推播要不要顯示？_ =>> **答案：不行**

#### 首先，後端推播程式的 Payload 部分

後端在推播時的結構要多加上一行 `“mutable-content":1` 系統收到推播才會執行Notification Service Extension
```
{
    "aps": {
        "alert": {
            "title": "新文章推薦給您",
            "body": "立即查看"
        },
        "mutable-content":1,
        "sound": "default",
        "badge": 0
    }
}
```
#### And… 第一步，為專案新建一個Target


![**Step 1\.** Xcode \-> File \-> New \-> Target](/assets/cb6eba52a342/1*ZjPVTxLR6ywAdk70Y7_J7A.png)

**Step 1\.** Xcode \-> File \-> New \-> Target


![**Step 2\.** iOS \-> Notification Service Extension \-> Next](/assets/cb6eba52a342/1*2KRusR8MJUim7UH1CmS7pw.png)

**Step 2\.** iOS \-> Notification Service Extension \-> Next


![**Step 3\.** 輸入Product Name \-> Finish](/assets/cb6eba52a342/1*sAuzxJPpohTGp-KV13yupg.png)

**Step 3\.** 輸入Product Name \-> Finish


![**Step 4\.** 點選 Activate](/assets/cb6eba52a342/1*3DF_fMQLSrGxTbmLY6CJAg.png)

**Step 4\.** 點選 Activate

**第二步，撰寫推播內容處理程式**


![找到Product Name/NotificationService\.swift檔](/assets/cb6eba52a342/1*UsCd2btDPK6GWKrYEA9LbQ.png)

找到Product Name/NotificationService\.swift檔
